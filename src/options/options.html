<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <script type="application/javascript" src="../chrome-polyfill.js"></script>
  <title>Settings &mdash; Save In</title>
  <link href="style.css" rel="stylesheet">
</head>

<body id="settings-page">
  <div>
    <a class="open-settings-in-window" href="options.html" target="_blank">Popout</a>
    &middot;
    <a href="variablelist.html" target="_blank">Variable List</a>
    &middot;
    <a href="clauselist.html" target="_blank">Clause List</a>
    &middot;
    <a class="external" href="https://github.com/gyng/save-in/">GitHub</a>
    &middot;
    <a class="external" href="https://github.com/gyng/save-in/blob/master/CHANGELOG.md">Changelog</a>

  </div>

  <form id="options">
    <h2 id="section-downloads">Downloads</h2>

    <label class="column">
      <h3>Directories</h3>
      <span>
        <h3 class="popout link" data-popout-for="variablelist.html">ðŸ““ Variable List</h3>
      </span>
      <p>
        <a href="#" class="help learn-more" data-help-for="help-paths">Guide: Create menu items</a>
      </p>
      <div class="help-text" id="help-paths">
        <h4>Creating context menu items</h4>
        <p>To create a menu item to save
          <code>cat.jpg</code> into the directory
          <code>~/downloads/i/cats</code>, with
          <code>~/downloads</code> as the default download directory, add the line
          <code>i/cats</code>.</p>

        <div class="demo-box" style="margin-top: 12px; align-items: flex-start;">
          <div class="demo-code left ">
            <pre class="click-to-copy">.
i/dogs
i/cats // cute!
---
v/cats
:date:/:day:/foo
</pre>
            <div class="caption">Settings</div>
          </div>
          <div class="demo-arrow">âž¡</div>

          <div class="demo-code">
            <pre>~/downloads/
~/downloads/i/dogs
~/downloads/i/cats
---
~/downloads/v/cats
~/downloads/2000-01-01/01/foo
</pre>
            <div class="caption">Default download dir
              <code>~/downloads</code>
            </div>
          </div>

          <div class="demo-arrow">âž¡</div>

          <pre class="demo-pic" style="background-image: url(i/menu-items.png)">






</pre>
        </div>

        <p>Note: You can only save relative to the default download directory. See the next guide for a workaround.</p>
      </div>
      </div>

      <p>
        <a href="#" class="help learn-more" data-help-for="help-symlink">Guide: Save outside the default downloads directory</a>
      </p>
      <div class="help-text" id="help-symlink">
        <h4>Saving outside the default download directory</h4>
        <p>The WebExtensions API does not allow files to be saved outside of the default download directory. A
          <a class="external" href="https://en.wikipedia.org/wiki/Symbolic_link" target="_blank">symlink</a> inside the default download directory can be used to get around this limitation.
        </p>

        <p>Invalid paths (
          <code>..</code> and
          <code>/</code>) are ignored. Files and directories with leading dots (
          <code>foo/.hidden</code>) are considered invalid by Firefox and Chrome.</p>

        <br>
        <a class="external" href="https://technet.microsoft.com/en-us/library/cc753194(v=ws.11).aspx" target="_blank">
          Windows
        </a>
        <pre class="click-to-copy">mklink /D C:\path\to\symlink D:\path\to\actual</pre>

        <a class="external" href="http://manpages.ubuntu.com/manpages/xenial/man1/ln.1.html" target="_blank">
          macOS/Unix
        </a>
        <pre class="click-to-copy">ln -s /path/to/actual /path/to/symlink</pre>

        <p>Make sure the target directories actually exist, or the extension will silently fail to download.</p>
      </div>

      <p>One path per line, relative to the default download directory.
        <code>.</code> downloads to the default download directory. Use
        <code>//</code> at the end of a line to add a comment.</p>
      <p>A symlink is needed to save outside the default download directory.</p>

      <textarea required type="textarea" id="paths" rows=10 placeholder="." spellcheck="false"></textarea>
      <div class="error-notification" id="error-paths">path errors</div>
    </label>

    <label>
      <input type="checkbox" id="enableLastLocation" /> Show last used menu item
    </label>

    <h3>Behavior</h3>

    <label>
      <input type="checkbox" id="links" /> Enable saving of links. Prefers sources if available.
    </label>

    <label>
      <input type="checkbox" id="selection" /> Enable saving of selected text with a
      <code>.selection.txt</code> extension
    </label>

    <label>
      <input type="checkbox" id="page" /> Enable saving of the current page
      <div class="caption caption-line">Does not save external resources</div>
    </label>

    <label>
      <input type="checkbox" id="prompt" /> Open a save file dialog when saving
    </label>

    <label>
      <input type="checkbox" id="promptIfNoExtension" /> Open a save file dialog if filename has no extension
    </label>

    <label>
      <input type="checkbox" id="promptOnShift" /> Open a save file dialog when menu item is clicked and SHIFT is held down
    </label>

    <label>
      <input type="checkbox" id="promptOnFailure" /> Open a save file dialog if download fails
    </label>

    <label>
      <select disabled class="chrome-enabled" id="conflictAction">
        <option value="uniquify">Uniquify</option>
        <option value="overwrite">Overwrite</option>
        <option value="prompt">Prompt</option>
      </select>
      when a duplicate filename is encountered
      <span class="badge">Chrome</span>
    </label>

    <hr>

    <label class="column">
      <h2>Dynamic Downloads (Advanced)</h2>

      <h3>Rename and Route Downloads</h3>

      <div style="display: flex; justify-content: flex-start; align-items: baseline;">
        <h3 style="width: auto;" class="popout link" data-popout-for="variablelist.html">ðŸ““ Variable list</h3>
        &nbsp;&nbsp;&nbsp;
        <h3 style="width: auto;" class="popout link" data-popout-for="clauselist.html">ðŸ““ Clause list</h3>
      </div>

      <p>
        <a href="#" class="help learn-more" data-help-for="help-filenames">Guide: Rename and route downloads</a>
        <a class="external float-right" href="https://github.com/gyng/save-in/wiki/Filename-rewrite">Templates</a>
      </p>
      </div>

      <div class="help-text" id="help-filenames">
        <h4>Renaming downloads</h4>
        <p>
          Match downloads against
          <a class="external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions">regex patterns</a>. When a download matches all patterns, rename it according to
          <code class="click-to-copy">into:</code>.

          <p>This renames all gif files to a UNIX timestamp.</p>
          <div class="demo-box">
            <pre class="demo-code left click-to-copy">
fileext: <span class="demo g3">gif</span>
into: <span class="demo g4">:unixdate:</span>.<span class="demo g3">:fileext:</span></pre>

            <div class="demo-arrow">=</div>

            <pre class="demo-code right">
cat.<span class="demo g3">gif</span> âž¡ <span class="demo g4">1512136516</span>.<span class="demo g3">gif</span>
 </pre>
          </div>

          <h4>Moving downloads into different directories</h4>

          <p>The following example moves all
            <code>.gif</code> files into the
            <code>gifs</code> subdirectory and renames the moved files to a timestamp.</p>


          <div class="demo-box">
            <pre class="demo-code left click-to-copy">
fileext: <span class="demo g3">gif</span>
into: <span class="demo g2">gifs</span>/<span class="demo g4">:unixdate:</span>.<span class="demo g3">:fileext:</span></pre>

            <div class="demo-arrow">=</div>

            <pre class="demo-code right">
cat.<span class="demo g3">gif</span> âž¡ <span class="demo g2">gifs</span>/<span class="demo g4">1512136516</span>.<span class="demo g3">gif</span>
cat.jpg âœ˜ (no match)</pre>
          </div>

          <p>Routing is relative to the selected menu item. When you download a cat gif using the
            <code>images</code> context menu, the above example will save it as
            <code>~/downloads/images/gif/946684800.gif</code>.
          </p>

          <p>This advanced example renames downloads based off captured regex groups &mdash; the stuff inside
            <code>()</code> &mdash; and moves them into different directories.
            <code class="click-to-copy">capture:&nbsp;filename</code> selects the filename&rsquo;s capture groups, and finally
            <code class="click-to-copy">into:</code> renames the files based off them using
            <code class="click-to-copy">:$1:</code>,
            <code class="click-to-copy">:$2:</code>, and
            <code class="click-to-copy">:$3:</code>.

            <div class="demo-box">
              <pre class="demo-code left click-to-copy">
// Move downloads based off versions
<span class="demo g1">filename:</span> <span class="demo g2">(.*)</span>\.<span class="demo g4">(v.)</span>\.<span class="demo g3">(tar|gz)</span>
pageurl: example.com
capture: <span class="demo g1">filename</span>
into: <span class="demo g4">:$2:</span>/<span class="demo g2">:$1:</span>.<span class="demo g3">:$3:</span></pre>
              <div class="demo-arrow">=</div>

              <pre class="demo-code right">

<span class="demo g2">ubuntu</span>.<span class="demo g4">v1</span>.<span class="demo g3">tar</span> âž¡ <span class="demo g4">v1</span>/<span class="demo g2">ubuntu</span>.<span class="demo g3">tar</span>
<span class="demo g2">debian</span>.<span class="demo g4">v2</span>.<span class="demo g3">gz</span>  âž¡ <span class="demo g4">v2</span>/<span class="demo g2">debian</span>.<span class="demo g3">gz</span>
<span class="demo g2">debian</span>.zip    âœ˜ (no match)
 </pre>
            </div>

            <a class="external" href="https://github.com/gyng/save-in/wiki/Filename-rewrite#migrating-to-the-new-syntax">Migrating rules from the old version</a>
      </div>
      </div>
      </div>

      <p>Automate routing of downloads or renaming of files. Separate multiple rules with an empty line. See the guide for more
        details.
      </p>

      <p class="chrome-only">CHROME USERS: Special characters in the filename (eg.
        <code>:</code> or
        <code>/</code>) are pre-replaced by Chrome. Match these characters using a
        <code>-</code> instead. For example, use
        <code>(.*)-large</code> to match filenames instead of
        <code>(.*):large</code>.
      </p>

      <textarea type="textarea" id="filenamePatterns" rows=7 placeholder="Optional" spellcheck="false"></textarea>
      <div class="error-notification" id="error-filenamePatterns">errors</div>
      <div style="display: flex; max-width: 100%; align-items: center; flex-wrap: wrap;">
        <div class="info-row" style="display: flex; flex-direction: column; flex: 1; align-items: baseline; margin-right: 8px;">
          <table style="margin: 0; padding: 0">
            <tbody style="margin: 0; padding: 0; vertical-align: baseline;">
              <tr>
                <td div style="font-weight: 600; padding: 0; text-align: left; min-width: 110px;">
                  Last download
                </td>
                <td style="font-family: monospace; text-overflow: hidden; overflow: hidden; white-space: nowrap;" id="last-dl-url">none yet</td>
              </tr>
              <tr class="hi2de" id="rules-applied-row">
                <td style="font-weight: 600; padding: 0; text-align: left;">Renamed to</td>
                <td style="font-family: monospace; word-break: break-all;" id="last-dl-match">no matches</td>
              </tr>
              <tr class="hide" id="capture-group-rows">
                <td style="font-weight: 600; padding: 0;">Capture groups</td>
                <td style="font-family: monospace; word-break: break-all;" id="last-dl-capture"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="caption caption-line">Test your current rules, applied to the last downloaded file</div>

    </label>

    <label>
      <input type="checkbox" id="routeFailurePrompt" /> Open a save file dialog if no rules match
    </label>

    <label>
      <input type="checkbox" id="routeExclusive" /> Exclusively use routing and renaming rules
      <div class="caption caption-line">Disables submenu for two-click downloads, saves relative to default downloads directory</div>
    </label>

    <hr>

    <h2 id="section-notifications">Notifications</h2>
    <label>
      <input type="checkbox" id="notifyOnSuccess" /> Show notification on successful download
    </label>

    <label>
      <input type="checkbox" id="notifyOnFailure" /> Show notification on failed download
    </label>

    <label>
      <input type="checkbox" id="notifyOnRuleMatch" /> Show notification on a rule match
    </label>

    <label>
      Close notifications early after
      <input type="number" id="notifyDuration" min="0" />ms
      <div class="caption caption-line">1s = 1000ms. Will not extend beyond OS/browser notification duration.</div>
    </label>

    <hr />

    <h2 id="section-save-as-shortcuts">Save As Shortcuts</h2>
    <label>
      Save shortcuts as
      <select id="shortcutType">
        <option value="HTML_REDIRECT">HTML redirect</option>
        <option value="MAC">Mac .url</option>
        <option value="WINDOWS">Windows .url</option>
        <option value="FREEDESKTOP">Freedesktop .desktop</option>
      </select>
    </label>

    <label>
      <input type="checkbox" id="shortcutMedia" /> Save media as shortcuts instead
    </label>

    <label>
      <input type="checkbox" id="shortcutLink" /> Save links as shortcuts instead
    </label>

    <label>
      <input type="checkbox" id="shortcutPage" /> Save pages as shortcuts instead
    </label>

    <hr>

    <h2 id="section-save-as-shortcuts">Keyboard Shortcuts</h2>

    <h3>Context Menu
      <span class="badge">Chrome</span>
    </h3>
    <p>Set accesskeys for Save In menu items. This does not work on macOS as it does not support accesskeys.</p>

    <label>
      <input disabled class="chrome-enabled key" type="text" id="keyRoot" maxlength="1" /> Save In context menu item
    </label>

    <label>
      <input disabled class="chrome-enabled key" type="text" id="keyLastUsed" maxlength="1" /> Last used context submenu item
    </label>

    <label>
      <input disabled class="chrome-enabled" type="checkbox" id="enableNumberedItems" /> Add number key shortcuts to context submenu items
    </label>

    <h3>Click To Save</h3>
    <label>
      <input type="checkbox" id="contentClickToSave" /> Enable click to save
      <div class="caption caption-line">Hold down Alt (default) and click images or media to save them in the last used directory or default download directory.
        Injects a script into pages to listen for click events. Not all variables are available when using this. Requires
        page refresh to take effect.</div>
    </label>

    <label>
      <input type="number" id="contentClickToSaveCombo" /> Click-to-save modifier keycode
      <div class="caption caption-line">Modifier keycode for click-to-save. Requires page refresh to take effect.
        <a class="caption" href="http://keycode.info/">keycode.info</a>
      </div>
    </label>

    <hr>

    <h2 id="section-more-options">More Options
      <div id="reset" class="button float-right">Restore Defaults</div>
    </h2>

    <label>
      Truncate path components to
      <input type="number" id="truncateLength" min="1" /> characters
      <div class="caption caption-line">0 = no truncation</div>
    </label>

    <label>
      Replace invalid characters with
      <input type="text" id="replacementChar" placeholder="delete" style="font-family: monospace;" />
      <div class="caption caption-line">Leave blank to delete. Invalid replacement characters are ignored.</div>
    </label>

    <label>
      <input type="checkbox" id="fetchViaContent" class="chrome-disabled" />
      <span style="margin: 0 5px">Enable fetching via content script</span>
      <span class="badge">Firefox</span>
      <span class="warning badge">Experimental</span>
      <div class="caption caption-line">Slower and prone to failure. Send headers from page with download request. Success/failure notifications do not work
        in this mode. Requires page refresh to take effect.</div>
    </label>

    <div style="display: flex; justify-content: flex-start; align-items: center;">
      <div id="settings-import" class="button">Import Settings</div>
      <div style="margin-left: 8px;" id="settings-export" class="button">Export Settings</div>
      <div style="margin-left: 8px;" id="print-debug-info" class="button">Show Debug Information</div>
    </div>

    <div id="show-last-download" class="button" style="align-self: flex-start">Last Download Info</div>

    <label>
      <input type="checkbox" id="debug" /> Enable debug logging
    </label>

    <p>
      <span>Last saved at:&nbsp;</span>
      <span id="lastSavedAt">never</span>
    </p>
  </form>

  <script src="options.js"></script>
  <script src="clicktocopy.js"></script>
</body>

</html>