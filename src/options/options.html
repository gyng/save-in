<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <script type="application/javascript" src="../chrome-polyfill.js"></script>
  <title>Settings &mdash; Save In</title>
  <link href="style.css" rel="stylesheet">
</head>

<body id="settings-page">
  <div>
    <a class="open-settings-in-window" href="options.html" target="_blank">Popout this page</a>
    &middot;
    <a href="variablelist.html" target="_blank">Variable list</a>
    &middot;
    <a href="clauselist.html" target="_blank">Clause list</a>
    &middot;
    <a class="external" href="https://github.com/gyng/save-in/">GitHub</a>
    &middot;
    <a class="external" href="https://github.com/gyng/save-in/blob/master/CHANGELOG.md">Changelog</a>

  </div>

  <form id="options">
    <h2 id="section-downloads">Downloads</h2>
    <h3 class="popout link" data-popout-for="variablelist.html">ðŸ““ Variable List</h3>

    <label class="column">
      <h3>Directories</h3>
      <a href="#" class="help learn-more" data-help-for="help-paths">Guide: Create menu items</a>
      <p>One path per line, relative to the default download directory.
        <code>.</code> downloads to the default download directory.</p>
      <p>A symlink is needed to save outside the default download directory.</p>
      <div class="help-text" id="help-paths">
        <h4>Creating context menu items</h4>
        <div class="demo-box" style="margin-top: 12px; align-items: flex-start;">
          <div class="demo-code left ">
            <pre class="click-to-copy">.
i/dogs
i/cats
---
v/cats
:date:/:day:/foo
</pre>
            <div class="caption">Settings</div>
          </div>
          <div class="demo-arrow">âž¡</div>

          <div class="demo-code">
            <pre>~/downloads/
~/downloads/i/dogs
~/downloads/i/cats
---
~/downloads/v/cats
~/downloads/2000-01-01/01/foo
</pre>
            <div class="caption">Default download dir
              <code>~/downloads</code>
            </div>
          </div>

          <div class="demo-arrow">âž¡</div>

          <pre class="demo-pic" style="background-image: url(i/menu-items.png)">






</pre>
        </div>

        <p>Saving a picture
          <code>cat.jpg</code> into
          <code>i/cats</code> will save it as
          <code>~/downloads/i/cats/cat.jpg</code>.</p>

        <p>Invalid paths (
          <code>..</code> and
          <code>/</code>) are ignored. Files and directories with leading dots (
          <code>foo/.hidden</code>) are considered invalid by Firefox and Chrome.</p>

        <h4>Saving outside the default download directory</h4>
        <p>The WebExtensions API does not allow files to be saved outside of the default download directory. A
          <a class="external" href="https://en.wikipedia.org/wiki/Symbolic_link" target="_blank">symlink</a> inside the default download directory can be used to get around this limitation.
        </p>

        <br>
        <a class="external" href="https://technet.microsoft.com/en-us/library/cc753194(v=ws.11).aspx" target="_blank">
          Windows
        </a>
        <pre class="click-to-copy">mklink /D C:\path\to\symlink D:\path\to\actual</pre>

        <a class="external" href="http://manpages.ubuntu.com/manpages/xenial/man1/ln.1.html" target="_blank">
          macOS/Unix
        </a>
        <pre class="click-to-copy">ln -s /path/to/actual /path/to/symlink</pre>

        <p>Make sure the target directories actually exist, or the extension will silently fail to download.</p>
      </div>
      <textarea type="textarea" id="paths" rows=10 placeholder="." spellcheck="false"></textarea>
      <div class="error-notification" id="error-paths">path errors</div>
    </label>

    <h3>Behavior</h3>

    <label>
      <input type="checkbox" id="links" /> Enable saving of links. Prefers sources if available.
    </label>

    <label>
      <input type="checkbox" id="selection" /> Enable saving of selected text with a
      <code>.selection.txt</code> extension
    </label>

    <label>
      <input type="checkbox" id="page" /> Enable saving of the current page
      <div class="caption caption-line">Does not save external resources</div>
    </label>

    <label>
      <input type="checkbox" id="prompt" /> Open a save file dialog when saving
    </label>

    <label>
      <input type="checkbox" id="promptIfNoExtension" /> Open a save file dialog if filename has no extension
    </label>

    <label>
      <select disabled class="chrome-enabled" id="conflictAction">
        <option value="uniquify">Uniquify</option>
        <option value="overwrite">Overwrite</option>
        <option value="prompt">Prompt</option>
      </select>
      when a duplicate filename is encountered
      <span class="badge">Chrome</span>
    </label>

    <hr>

    <label class="column">
      <h2>Dynamic Downloads (Advanced)</h2>
      <div style="display: flex; justify-content: flex-start; align-items: center;">
        <h3 style="width: auto;" class="popout link" data-popout-for="variablelist.html">ðŸ““ Variable list</h3>
        &nbsp;&nbsp;&nbsp;
        <h3 style="width: auto;" class="popout link" data-popout-for="clauselist.html">ðŸ““ Clause list</h3>
      </div>

      <h3>Rename and Route Downloads</h3>
      <a href="#" class="help learn-more" data-help-for="help-filenames">Guide: Rename and route downloads</a>

      <p>Automate routing of downloads or renaming of files. Separate multiple rules with an empty line. See the guide for more
        details.
      </p>

      <p class="chrome-only">CHROME USERS: Special characters in the filename (eg.
        <code>:</code> or
        <code>/</code>) are pre-replaced with the character
        <code>-</code> by Chrome. Match against
        <code>-</code> instead of these special characters. For example, use
        <code>(.*)-large</code> to match filenames instead of
        <code>(.*):large</code>.
      </p>
      </div>

      <div class="help-text" id="help-filenames">
        <h4>Rename filenames</h4>
        <p>
          Match downloads against
          <a class="external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions">regex patterns</a>. When a download matches all patterns, rename it according to
          <code class="click-to-copy">into:</code>.

          <p>This renames all gif files to a UNIX timestamp.</p>
          <div class="demo-box">
            <pre class="demo-code left click-to-copy">
fileext: <span class="demo g3">gif</span>
into: <span class="demo g4">:unixdate:</span>.<span class="demo g3">:fileext:</span></pre>

            <div class="demo-arrow">=</div>

            <pre class="demo-code right">
cat.<span class="demo g3">gif</span> âž¡ <span class="demo g4">1512136516</span>.<span class="demo g3">gif</span>
 </pre>
          </div>

          <h4>Route downloads into directories</h4>

          <p>The following example moves all
            <code>.gif</code> files into the
            <code>gifs</code> subdirectory and renames the moved files to a timestamp.</p>


          <div class="demo-box">
            <pre class="demo-code left click-to-copy">
fileext: <span class="demo g3">gif</span>
into: <span class="demo g2">gifs</span>/<span class="demo g4">:unixdate:</span>.<span class="demo g3">:fileext:</span></pre>

            <div class="demo-arrow">=</div>

            <pre class="demo-code right">
cat.<span class="demo g3">gif</span> âž¡ <span class="demo g2">gifs</span>/<span class="demo g4">1512136516</span>.<span class="demo g3">gif</span>
cat.jpg âœ˜ (no match)</pre>
          </div>


          <p>Routing is relative to the selected menu item. So, if you download a cat gif using the
            <code>images</code> context menu, the above example will save the cat as
            <code>./images/gif/946684800.gif</code>. See the clause list and the guide for more details.
          </p>

          <p>This advanced example renames downloads based off captured regex groups &mdash; the stuff inside
            <code>()</code>.
            <code class="click-to-copy">capture:&nbsp;filename</code> selects the filename's capture groups, and finally
            <code class="click-to-copy">into:</code> renames the files based off them using
            <code class="click-to-copy">:$1:</code> for the first one
            <code>(.*)</code>, and
            <code class="click-to-copy">:$2:</code> for the second one
            <code>(tar|gz)</code>.

            <div class="demo-box">
              <pre class="demo-code left click-to-copy">
<span class="demo g1">filename:</span> <span class="demo g2">(.*)</span>\.<span class="demo g3">(tar|gz)</span>
pageurl: dl.example.com
capture: <span class="demo g1">filename</span>
into: <span class="demo g2">:$1:</span>.<span class="demo g3">:$2:</span></pre>
              <div class="demo-arrow">=</div>

              <pre class="demo-code right">
<span class="demo g2">ubuntu</span>.<span class="demo g3">tar</span> âž¡ <span class="demo g2">ubuntu</span>.<span class="demo g3">tar</span>
<span class="demo g2">debian</span>.<span class="demo g3">gz</span>  âž¡ <span class="demo g2">debian</span>.<span class="demo g3">gz</span>
<span class="demo g2">debian</span>.zip âœ˜ (no match)
 </pre>
            </div>

            <a class="external" href="https://github.com/gyng/save-in/wiki/Filename-rewrite">Short list of useful rules</a>
      </div>
      </div>
      </div>
      <textarea type="textarea" id="filenamePatterns" rows=7 placeholder="Optional" spellcheck="false"></textarea>
      <div class="error-notification" id="error-filenamePatterns">errors</div>
    </label>

    <label>
      <input type="checkbox" id="routeFailurePrompt" /> Open a save file dialog if no rules match
    </label>

    <label>
      <input type="checkbox" id="routeExclusive" /> Exclusively use routing and renaming rules
      <div class="caption caption-line">Disables submenu for two-click downloads, saves relative to default downloads directory</div>
    </label>

    <hr>

    <h2 id="section-notifications">Notifications</h2>
    <label>
      <input type="checkbox" id="notifyOnSuccess" /> Show notification on successful download
    </label>

    <label>
      <input type="checkbox" id="notifyOnFailure" /> Show notification on failed download
    </label>

    <label>
      <input type="checkbox" id="notifyOnRuleMatch" /> Show notification on a rule match
    </label>

    <label>
      Close notifications early after
      <input type="number" id="notifyDuration" min="0" />ms
      <div class="caption caption-line">1s = 1000ms. Will not extend beyond OS/browser notification duration.</div>
    </label>

    <hr />

    <h2 id="section-save-as-shortcuts">Save As Shortcuts</h2>
    <label>
      Save shortcuts as
      <select id="shortcutType">
        <option value="HTML_REDIRECT">HTML redirect</option>
        <option value="MAC">Mac .url</option>
        <option value="WINDOWS">Windows .url</option>
        <option value="FREEDESKTOP">Freedesktop .desktop</option>
      </select>
    </label>

    <label>
      <input type="checkbox" id="shortcutMedia" /> Save media as shortcuts instead
    </label>

    <label>
      <input type="checkbox" id="shortcutLink" /> Save links as shortcuts instead
    </label>

    <label>
      <input type="checkbox" id="shortcutPage" /> Save pages as shortcuts instead
    </label>

    <hr>

    <h2 id="section-more-options">More Options
      <div id="reset" class="button float-right">Restore Defaults</div>
    </h2>

    <label>
      Truncate path components to
      <input type="number" id="truncateLength" min="1" /> characters
      <div class="caption caption-line">0 = no truncation</div>
    </label>

    <label>
      Replace invalid characters with
      <input type="text" id="replacementChar" placeholder="delete" style="font-family: monospace;" />
      <div class="caption caption-line">Leave blank to delete. Invalid replacement characters are ignored.</div>
    </label>

    <div style="display: flex; justify-content: flex-start; align-items: center;">
      <div id="settings-export" class="button">Export Settings</div>
      <div style="margin-left: 8px;" id="print-debug-info" class="button">Show Debug Information</div>
    </div>

    <div style="display: flex; justify-content: flex-start; align-items: center;">
      <input id="settings-import-field" type="text" placeholder="{}"></input>
      <div style="margin-left: 8px;" id="settings-import" class="button">Import Settings</div>
      <div style="margin-left: 8px;" class="error-row hide" id="settings-import-error"></div>
    </div>

    <label>
      <input type="checkbox" id="debug" /> Enable debug logging
    </label>
  </form>

  <script src="options.js"></script>
  <script src="clicktocopy.js"></script>
</body>

</html>